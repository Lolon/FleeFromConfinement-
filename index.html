<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>To Escape Confinement</title>
  <script src="aframe-v0.7.1.js"></script>
  <script src="aframe-animation-component.js"></script>
  <script src="aframe-layout-component.js"></script>
  <script src="aframe-event-set-component.js"></script>
  <script src="nunjucks.js"></script>
  <script src="aframe-template-component.js"></script>
</head>

<body>

<a-scene>
  <a-assets>
    <script id="baseinteractionobject" type="text/x-nunjucks-template">
    //Base code for props
      <a-box height="1.5" depth="1.5" width="1.5"
            material="color: {{ ocol }}"
            class="scene"
      ></a-box>
    </script>
  </a-assets>
  <!--the sky! --><a-sky color="#6EBAA7"></a-sky>
  <!--a basic floor plane--> <a-plane color="#CCC" height="20" width="20" rotation="-90 0 0"></a-plane>

  <!-- a placeholder for the base object--> <a-entity id="testObjEntity" template="src: #baseinteractionobject" data-ocol="#33FE77" position="0 0 10" ></a-entity>
  <!--the begin screen -->  <a-entity id="beginscreen" position="0 2.033 -1.5" class="scene"
                                                <a-text="" value="Title" width="11" text__titletext="zOffset:0.021;baseline:bottom;width:7.7;height:0.11;align:center;value:Title;color:#070707"
                                                text__starttext="zOffset:0.02;baseline:top;width:5.29;lineHeight:7.05;letterSpacing:0.41;align:center;wrapCount:42.22;tabSize:4.08;color:#000000;value:Stare here to start"
                                                geometry="width:1.9100000000000001;primitive:plane">
                                                        <!--text="width:11; tabSize:4.82; color:#0b0b0b; align:center; value:Title"
                                                        text="width:7; tabSize:4.82; color:#0b0b0b; align:center; value:stare here to start"
                                                        geometry="primitive: plane; position: 0 -1 0" -->
                                                  &gt;</a-entity>
  <!--Timer-->       <a-text id="timer" value="120" position="0 2 -1.75" text="width:12.03;color:#ff171d" align="center"></a-text>
  <!--circle hud-->  <a-entity layout="type: circle; radius: 4" position="0 0.5 0" rotation="0 10 0"></a-entity>
  <!--player -->  <a-entity position="0 0 0" id="player">
                  <a-camera>
                      <a-cursor fuse id="cursor" raycaster="objects: .scene"
                        animation__click="property: scale; startEvents: click; from: 0.1 0.1 0.1; to: 1 1 1; dur: 150"
                        animation__fusing="property: scale; startEvents: fusing; from: 1 1 1; to: 0.1 0.1 0.1; dur: 1500"
                        event-set__1="_event: mouseenter; color: limegreen"
                        event-set__2="_event: mouseleave; color: black">
                      </a-cursor>
                    </a-camera>
                  </a-entity>
</a-scene>

<script>
var scene = document.querySelector('a-scene');
if (scene.hasLoaded === true) { run(); } else { scene.addEventListener('loaded', run());}

function run() {    //starting logic
var beginScreen = document.querySelector('#beginscreen');
  beginScreen.addEventListener('click', function(){
    this.setAttribute('visible', 'false');
    this.setAttribute('class', 'none'); //stop overlay
    this.setAttribute('position', '0 -10 -1.5');
    setTimeout(function(){
    beginescape();
    }.bind(this), 1000);
  })
}

function beginescape() {  //begin escape logic
var timer = document.querySelector('#timer')
var testobj = document.querySelector('#testObjEntity');
var time = 120;
var timerpause = false;

setInterval(SetTimer, 1000);

function SetTimer(){
  if (timerpause === true){

  }
  else if (time === 1) {

  }
  else {
    time = time - 1;
    timer.setAttribute('value', time);
  }
}

    testobj.addEventListener('click', function (){
      this.setAttribute('position', '0 0 11');
      timerpause = true;
    });
}
</script>
</body>
</html>
